# Generate a signed URL

In addition to including the Authorization header in the request, you can also add signature information to a URL so that you can forward the URL to a third party for authorized access.

**Note:**

-   If you generate a signed URL, the data that is authorized will be exposed to the Internet as long as the authorization is valid. We recommend that you assess the risks in advance.
-   A signature cannot be included in a URL and a header at the same time.
-   You can add a signature to a URL for a PUT or GET request.
-   You can generate a presigned URL for a PUT operation. The presigned URL checks whether the user uploads valid content. OSS SDK calculates the checksum of the request body and generates an MD5 checksum before OSS SDK generates a presigned URL for the request. The MD5 checksum is included in the presigned URL. The user must upload content that has the same checksum as the MD5 checksum generated by OSS SDK. Otherwise, the operation fails. To verify the MD5 checksum, add the Content-MD5 header to the request.

## Sample codes

The following code provides an example on how to generate a signed URL in Python:

```
import base64
import hmac
import hashlib
import urllib
h = hmac.new("OtxrzxIsfpFjA7SwPzILwy8Bw21TLhquhboDYROV",
             "GET\n\n\n1141889120\n/oss-example/oss-api.pdf",
             hashlib.sha1)
urllib.quote (base64.encodestring(h.digest()).strip())
```

OSS SDKs provide methods on how to generate a signed URL. For more information, see [SDK reference](/intl.en-US/SDK Reference/Introduction.md).

The following table describes how to generate a signed URL by using OSS SDKs.

|SDK|URL signature method|Implementation file|
|:--|:-------------------|:------------------|
|Java SDK|OSSClient.generatePresignedUrl|[OSSClient.java](https://github.com/aliyun/aliyun-oss-java-sdk/blob/master/src/main/java/com/aliyun/oss/OSSClient.java?spm=a2c4g.11186623.2.6.30uUQV&file=OSSClient.java)|
|Python SDK|Bucket.sign\_url|[api.py](https://github.com/aliyun/aliyun-oss-python-sdk/blob/master/oss2/api.py?spm=a2c4g.11186623.2.7.30uUQV&file=api.py)|
|.Net SDK|OssClient.GeneratePresignedUri|[OssClient.cs](https://github.com/aliyun/aliyun-oss-csharp-sdk/blob/master/sdk/OssClient.cs?spm=a2c4g.11186623.2.8.30uUQV&file=OssClient.cs)|
|PHP SDK|OssClient.signUrl|[OssClient.php](https://github.com/aliyun/aliyun-oss-php-sdk/blob/master/src/OSS/OssClient.php?spm=a2c4g.11186623.2.9.30uUQV)|
|JavaScript SDK|signatureUrl|[Object.js](https://github.com/ali-sdk/ali-oss/blob/master/lib/object.js?spm=a2c4g.11186623.2.10.30uUQV&file=object.js)|
|C SDK|oss\_gen\_signed\_url|[oss\_object.c](https://github.com/aliyun/aliyun-oss-c-sdk/blob/master/oss_c_sdk/oss_object.c?spm=a2c4g.11186623.2.11.30uUQV&file=oss_object.c)|
|C++ SDK|OssClient::GeneratePresignedUrl|[OssClient.cc](https://github.com/aliyun/aliyun-oss-cpp-sdk/blob/master/sdk/src/OssClient.cc)|

## Implementation method

The following code provides an example on how to generate a signed URL:

```
http://oss-example.oss-cn-hangzhou.aliyuncs.com/oss-api.pdf?OSSAccessKeyId=nz2pc56s936**9l&Expires=1141889120&Signature=vjbyPxybdZaNmGa%2ByT272YEAiv4%3D
```

A signed URL must include the following three parameters: Signature, Expires, and OSSAccessKeyId. When you generate the signature string, replace Date with Expires, but include the headers such as content-type and content-md5 defined in [Add signatures to headers](/intl.en-US/API Reference/Access control/Add signatures to headers.md). \(Although Date still exists in the request header, you do not need to add it to the signature string.\)

-   Expires specifies the expire date of the URL. The value of this parameter is in [UNIX time](https://baike.baidu.com/item/unix时间戳/2078227?fr=aladdin) format. The value is the number of seconds that elapsed since January 1, 1970 UTC. If the time OSS receives the URL request is later than the value of Expires that is included in the signature, a request timeout error is returned. For example, the current time is 1141889060. To create a URL that expires in 60 seconds, you can set the value of Expires to 1141889120.

    **Note:** For security reasons, the default validity period of a URL is 3,600 seconds. The maximum validity period of a URL is 32,400 seconds.

-   OSSAccessKeyId specifies the AccessKey ID of a key.
-   Signature specifies the signature information. For all requests and headers that OSS supports, the signature algorithm for a URL is basically the same as that for a header in [Add signatures to headers](/intl.en-US/API Reference/Access control/Add signatures to headers.md).

    ```
    Signature = urlencode(base64(hmac-sha1(AccessKeySecret,
              VERB + "\n" 
              + CONTENT-MD5 + "\n" 
              + CONTENT-TYPE + "\n" 
              + EXPIRES + "\n" 
              + CanonicalizedOSSHeaders
              + CanonicalizedResource)))
    ```

    For more information about values of the `CONTENT-MD5`, `CanonicalizedOSSHeaders`, and `CONTENT-TYPE` headers, see [Add signatures to headers](/intl.en-US/API Reference/Access control/Add signatures to headers.md).

    **Note:** The signature algorithm for a URL and the signature algorithm for a header have the following differences:

    -   When a signed URL is created, the Expires parameter replaces the Date parameter.
    -   If more than one Signature, Expires, or OSSAccessKeyId value is imported, the first input value is used.
    -   Before the signature of a request is verified, OSS checks the request time to determine whether it is later than the time specified in Expires.
    -   When you add a signature string to a URL, you must encode the URL.
-   When you add a signature to a temporary user URL, you must include `security-token` in the following format:

    ```
    http://oss-example.oss-cn-hangzhou.aliyuncs.com/oss-api.pdf?OSSAccessKeyId=nz2pc56s936**9l&Expires=1141889120&Signature=vjbyPxybdZaNmGa%2ByT272YEAiv4%3D&security-token=SecurityToken
    ```


## Error codes

|Error code|Error message|Description|
|----------|-------------|-----------|
|AccessDenied|403 Forbidden|The error message returned because one or more of the Signature, Expires, and OSSAccessKeyId parameters are missing. When a signature is added to a URL, the sequence of the Signature, Expires, and OSSAccessKeyId parameters can be swapped.|
|AccessDenied|403 Forbidden|The error message returned because the current access time is later than the Expires value set in the request, or the time is incorrectly formatted.|
|InvalidArgument|400 Bad Request|The error message returned because a URL includes one or more of the Signature, Expires, and OSSAccessKeyId parameters and the header also includes the signature information.|

