# 设置跨区域复制

您可以使用跨区域复制功能将源Bucket中Object的改动（新建、覆盖、删除等操作）自动、异步（近实时）复制到目标Bucket中，以实现跨区域容灾或数据复制等需求。

使用跨区域复制时需注意以下事项：

-   费用说明
    -   进行跨区域复制时，OSS会根据复制文件产生的流量收取跨区域复制流量费用。计费方式，请参见[跨区域复制流量费用](/intl.zh-CN/计量计费/计量项和计费项/流量费用.md)。
    -   每同步1个Object，OSS会计算请求次数并收取请求费用。计费方式，请参见[请求费用](/intl.zh-CN/计量计费/计量项和计费项/请求费用.md)。
    -   若开启传输加速功能，OSS还会额外收取传输加速费用。计费方式，请参见[传输加速费用](/intl.zh-CN/计量计费/计量项和计费项/传输加速费用.md)。
-   使用限制
    -   源Bucket和目标Bucket必须分属两个不同地域。
    -   源Bucket和目标Bucket都不能与其他Bucket存在互相同步的关系。例如已设置Bucket A的数据同步至Bucket B，则Bucket A和Bucket B都不能与其他Bucket再建立数据同步关系。
    -   源Bucket和目标Bucket必须同时处于非版本化或启用版本控制状态，且处于同步状态下的两个Bucket不允许改变其版本控制状态。

关于跨区域复制的更多信息，请参见[跨区域复制介绍](/intl.zh-CN/开发指南/数据安全/数据容灾/跨区域复制介绍.md)。

## 开启跨区域复制

1.  登录[OSS管理控制台](https://oss.console.aliyun.com/)。

2.  在左侧导航栏，单击**Bucket列表**，之后单击目标Bucket。

3.  在左侧导航栏，选择**冗余与容错** \> **跨区域复制**。

4.  单击**开启同步**，在跨区域复制面板配置以下参数。

    |参数|说明|
    |--|--|
    |**源Bucket地域**|显示您当前Bucket所在地域。|
    |**源Bucket**|显示您当前Bucket名称。|
    |**目标地域**|选择目标Bucket所在地域。|
    |**目标Bucket**|选择开启数据同步的目标Bucket。|
    |**加速类型**|加速类型仅支持**传输加速**。传输加速可用于提升在中国内地与非中国内地之间跨区域复制时的传输速度。传输加速功能介绍，请参见[传输加速](/intl.zh-CN/开发指南/存储空间（Bucket）/传输加速.md)。|
    |**数据同步对象**|选择需要同步的源数据。     -   **全部文件进行同步**：将该Bucket内所有的Object同步到目标存储空间。
    -   **指定文件名前缀进行同步**：将该Bucket内指定前缀的Object同步到目标Bucket。最多可以添加10个前缀。 |
    |**Object标签**|同步拥有指定标签的Object到目标Bucket。设置方法为选中**设置规则**后添加标签（键-值对），最多可添加10个标签。要设置该参数，必须满足以下条件：

    -   已设置Object标签。具体操作，请参见[设置对象标签](/intl.zh-CN/控制台用户指南/上传、下载和管理文件/设置对象标签.md)。
    -   源Bucket和目标Bucket均已开启版本控制。
    -   数据同步策略为**增/改 同步**。
    -   源地域为华东1（杭州），目标地域为除华东1（杭州）以外的任何一个地域；或者源地域为澳大利亚（悉尼），目标地域为除中国内地和澳大利亚（悉尼）以外的任何一个地域。 |
    |**数据同步策略**|选择数据同步的方式。     -   **增/改 同步**：仅将该Bucket内Object新增和更新操作同步到目标Bucket。
    -   **增/删/改 同步**：将该Bucket内Object的新增、更新、删除操作同步到目标Bucket。
有关跨区域复制结合版本控制的行为说明，请参见[跨区域复制结合版本控制](/intl.zh-CN/开发指南/数据安全/数据容灾/特殊场景下的复制行为.md)。 |
    |**同步历史数据**|选择是否同步跨区域复制规则生效前源Bucket中已有的历史数据。    -   **同步**：将历史数据同步至目标Bucket。

**说明：** 同步历史数据时，从源Bucket复制的Object可能会覆盖目标Bucket中同名的Object。为避免这部分文件丢失，建议您对源Bucket和目标Bucket开启版本控制。

    -   **不同步**：仅同步跨区域复制规则生效后上传或更新的Object。 |
    |**KMS加密目标对象**|在源Object或者目标Bucket使用了KMS托管密钥加密方式（即SSE-KMS，指定CMK ID）的情况下，要将Object复制到目标Bucket，则必须选中**KMS加密目标对象**，并配置以下参数：    -   **使用的KMS密钥**：为目标Object指定加密的KMS密钥。

您需要提前在KMS平台创建一个与目标Bucket相同地域的KMS密钥。具体操作，请参见[管理密钥]()。

    -   **授权角色**：授权一个RAM角色对目标Object执行KMS加密操作。
        -   **新建角色**：新建RAM角色对目标Object执行KMS加密，角色名称格式为`kms-replication-源Bucket名称-目标Bucket名称`。
        -   **AliyunOSSRole**：使用AliyunOSSRole角色对目标Object执行KMS加密。若您之前未创建AliyunOSSRole角色，当您选择此项时，OSS将自动创建AliyunOSSRole角色。
**说明：**

    -   您可以通过[HeadObject](/intl.zh-CN/API 参考/关于Object操作/基础操作/HeadObject.md)和[GetBucketEncryption](/intl.zh-CN/API 参考/关于Bucket的操作/加密（Encryption）/GetBucketEncryption.md)分别查询源Object和目标Bucket的加密状态。
    -   有关跨区域复制结合服务器端加密详情，请参见[跨区域复制结合服务器端加密](/intl.zh-CN/开发指南/数据安全/数据容灾/特殊场景下的复制行为.md)。 |

5.  单击**确定**。

    -   当跨区域复制规则创建完成后，不允许对此规则进行编辑或删除。
    -   同步任务会在跨区域复制规则配置完成的3~5分钟后启动。您可以在源Bucket管理页面选择**冗余与容错** \> **跨区域复制**查看同步进度。
    -   由于Bucket间的跨区域复制采用异步（近实时）复制，数据复制到目标Bucket需要的时间取决于数据的大小，通常几分钟到几小时不等。

## 停止跨区域复制

您可以通过单击**关闭同步**来停止跨区域复制。

![sync](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/3594459951/p135995.png)

关闭同步后，已复制的数据将被保留在目标Bucket中，源Bucket中的增量数据将不再复制到目标Bucket。

