# Discuz如何存储远程附件到OSS

本文介绍如何基于Discuz论坛存储远程附件。

-   已创建一个公共读权限的存储空间（Bucket）。

    配置步骤请参见[创建存储空间](/intl.zh-CN/控制台用户指南/存储空间管理/创建存储空间.md)。

-   已搭建Discuz论坛。

网站远程附件功能是指将用户上传的附件直接存储到远端的存储服务器，一般是通过FTP方式存储到远程的FTP服务器。目前Discuz论坛、phpwind论坛、Wordpress个人网站等都支持远程附件功能。

本文档测试所用Discuz版本为Discuz! X3.1。

## 配置步骤

1.  使用管理员账号登录Discuz站点。

2.  在管理界面单击**全局**，之后单击**上传设置**。

3.  单击**远程附件**，之后设置远程附件各参数。

    |配置项|说明|
    |---|--|
    |**启用远程附件**|选择**是**。|
    |**启用SSL连接**|选择**否**。|
    |**FTP服务器地址**|运行ossftp工具的地址，通常填写127.0.0.1即可。|
    |**FTP服务器端口**|默认为2048。|
    |**FTP帐号**|格式为AccessKey ID/Bucket名称。|
    |**FTP密码**|即AccessKey Secret。|
    |**被动模式连接**|选择**是**。|
    |**远程附件目录**|填写后，FTP服务将在OSS的指定路径创建远程附件的上传目录。示例填写半角句号（.），表示在Bucket的根目录下创建上传目录。|
    |**远程访问URL**|填写Bucket的外网访问域名，格式为`https://BucketName.Endpoint`。测试所用Bucket名为test-hz-jh-002，位于华东1（杭州）地域。所以这里填写的是`https://test-hz-jh-002.oss-cn-hangzhou.aliyuncs.com`。关于访问域名的详情请参见[OSS访问域名使用规则](/intl.zh-CN/开发指南/访问域名（Endpoint）/OSS访问域名使用规则.md) 。|
    |**超时时间**|设置为0，表示使用服务器默认超时时间。|

4.  完成设置后，可以单击**测试远程附件**确认配置是否正常。

5.  发帖验证配置是否成功。

    1.  发贴时上传图片附件。

    2.  在图片上右键单击，之后单击**在新标签页中打开链接**。

        通过图中的URL，可以判断图片已经上传到test-hz-jh-002 Bucket。


